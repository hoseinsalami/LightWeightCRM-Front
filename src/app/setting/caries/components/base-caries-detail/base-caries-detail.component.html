<div class="p-card p-4 shadow-2 mx-auto max-w-60rem">

  <div class="grid">
    <div class="col-12">
      <div class="mt-3 mr-3">
        <button type="button" pButton pRipple
                class="p-button-success"
                label="ثبت"
                (click)="manager.save()">
        </button>
        <button type="button" pButton pRipple
                class="mr-4 p-button-danger"
                label="انصراف"
                (click)="manager.cancel()">
        </button>
      </div>
    </div>
  </div>

  <p-divider type="solid" [style]="{'border-top':'1px solid #d1d1d1',}"/>

  <div class="grid">
    <div class="col-12 md:col-4">
      <div class="flex flex-column flex-1">
        <label for="title">عنوان کاریز</label>
        <input
          pInputText
          id="title"
          name="title"
          [(ngModel)]="manager.oneObject.title"/>
      </div>
    </div>

    <div class="col-12 md:col-4">
      <div class="datePickerContainer relative">
        <label class="text-right font-bold text-md mb-2">راهبر</label>
        <div>
          <p-dropdown
            [styleClass]="'clear-icon'"
            [showClear]="true"
            [options]="adminUsers"
            [(ngModel)]="manager.oneObject.pathAdminId"
            class="mt-2"
            [style]="{'width':'100%'}"
            optionLabel="fullName"
            optionValue="id"
            placeholder="راهبر برای کاریز خود انتخاب کنید">
          </p-dropdown>
        </div>
      </div>
    </div>

    <div class="col-12 md:col-4">
      <div class="form-group">
        <label class="text-right font-bold text-md mb-2">کارشناس</label>
        <div class="field">
          <p-multiSelect [style]="{'width':'100%'}"
                         name="userType"
                         class="w-full"
                         placeholder ="کارشناسان خود را انتخاب نمایید"
                         scrollHeight="250px"
                         display="chip"
                         optionLabel="fullName"
                         optionValue="id"
                         [(ngModel)]="manager.oneObject.pathExpertIds"
                         [options]="expertUsers">
          </p-multiSelect>
        </div>
      </div>
    </div>

    <div class="col-12 md:col-12">
      <div class="flex flex-column flex-1">
        <label for="description">توضیحات</label>
        <textarea
          id="description"
          name="description"
          rows="5"
          cols="30"
          pInputTextarea
          [autoResize]="false"
          [(ngModel)]="manager.oneObject.description">
        </textarea>
      </div>
    </div>

    <div class="col-12">
      <div class="grid">
        <div class="col-12 md:col-3"></div>

        <div class="col-12 md:col-6 mt-2 ">

          <p-orderList
            #orderList
            [value]="manager.oneObject.steps ? manager.oneObject.steps : []"
            [style]="{'direction': 'ltr'}"
            [dragdrop]="true"
            (onReorder)="changeOrder()">

            <ng-template pTemplate="header">
              <p class="text-center">گام های کاریز</p>
            </ng-template>

            <ng-template let-item let-i="index" pTemplate="item">
              <div class="lex" style="direction: rtl !important;">
                <div class="flex align-items-end mb-3 gap-3">
                  <div class="flex flex-column flex-1">
                    <label class="text-right">عنوان</label>
                    <input
                      pInputText
                      id="steps"
                      name="steps"
                      [(ngModel)]="item.title"
                      (keydown)="handleSpace($event)"/>
                  </div>
                  <div class="form-group flex gap-3">
                    <input
                      pInputText
                      type="text"
                      id="reminder"
                      name="reminder"
                      class="p-fieldset"
                      placeholder="مدت زمان"
                      [style]="{'width':'150px'}"
                      [(ngModel)]="item.deadlineValue"
                      [pKeyFilter]="'int'">
                  </div>

                  <div class="form-group flex gap-3">
                    <p-dropdown
                      [styleClass]="'clear-icon'"
                      [showClear]="true"
                      [options]="TimeUnits"
                      [(ngModel)]="item.periodTimeUnit"
                      optionLabel="title"
                      optionValue="value"
                      class="mt-2"
                      [style]="{'width':'150px'}"
                      [required]="true"
                      [appendTo]="'body'"
                      placeholder="زمان">
                    </p-dropdown>
                  </div>



                  <div class="form-group flex gap-3">
                    <button [disabled]="i === 0"
                      type="button" pButton pRipple
                      class="p-button-danger w-full"
                      label="حذف"
                      (mousedown)="onDeleteStep(item)">
                    </button>
                  </div>
                </div>
              </div>
            </ng-template>

          </p-orderList>
          <div class="form-group mt-3">
            <button type="submit" pButton
                    class="p-button-success w-full"
                    label="افزودن گام جدید"
                    (click)="onAddNewStep()">
            </button>
          </div>




          <!--                  <div class="flex align-items-end mb-3 gap-3" *ngFor="let step of getPhonesFormControls(); let i = index">-->
          <!--                    <div class="flex flex-column flex-1">-->
          <!--                      <label for="username">عنوان</label>-->
          <!--                      <input-->
          <!--                        pInputText-->
          <!--                        id="step"-->
          <!--                        name="step"-->
          <!--                      />-->
          <!--                    </div>-->
          <!--                    <div class="form-group flex gap-3">-->
          <!--                      <p-button *ngIf=" i === getPhonesFormControls().length - 1"-->
          <!--                        icon="pi pi-plus"-->
          <!--                        severity="success"-->
          <!--                        (click)="onAddNewStep()"/>-->
          <!--                      <p-button icon="pi pi-times" severity="danger" (click)="onDeleteStep(i)"/>-->
          <!--                    </div>-->
          <!--                  </div>-->

        </div>

      </div>

    </div>

  </div>
</div>
